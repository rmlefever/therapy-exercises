<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fear Inventory Checklist</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            padding: 20px;
            background-color: #f0f7ff;
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #2c5282;
        }

        .category {
            background-color: #ffffff;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(137, 207, 240, 0.25);
            border: 2px solid #bde0ff;
        }

        .category h2 {
            color: #2d4a8c;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .subcategory {
            margin: 20px 0;
        }

        .subcategory h3 {
            color: #3182ce;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .fear-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .fear-item:hover {
            background-color: #f8fbff;
        }

        .fear-item input[type="checkbox"] {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .fear-item label {
            cursor: pointer;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .download-btn {
            background-color: #3182ce;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            font-size: 16px;
            transition: all 0.2s;
        }

        .download-btn:hover {
            background-color: #2c5282;
            transform: translateY(-1px);
        }

        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .upload-btn {
            background-color: #3182ce;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }

        .upload-btn:hover {
            background-color: #2c5282;
            transform: translateY(-1px);
        }

        .clear-btn {
            background-color: #e53e3e;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }

        .clear-btn:hover {
            background-color: #c53030;
            transform: translateY(-1px);
        }

        .analyze-btn {
            background-color: #48bb78;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }

        .analyze-btn:hover {
            background-color: #38a169;
            transform: translateY(-1px);
        }

        .analysis-section {
            background-color: #f8fafc;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .analysis-section h4 {
            color: #2d3748;
            margin-bottom: 15px;
        }

        .analysis-prompt {
            margin-bottom: 15px;
        }

        .analysis-textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            margin-bottom: 10px;
            font-family: inherit;
            resize: vertical;
        }

        .analysis-textarea:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
    </style>
</head>
<body>
    <input type="file" id="fileInput" style="display: none;" accept=".txt">

    <h1>Fear Inventory Checklist</h1>

    <div class="category">
        <h2>Common Personal Fears</h2>
        
        <div class="subcategory">
            <h3>Emotional Fears</h3>
            <div class="fear-item">
                <input type="checkbox" id="fear1">
                <label for="fear1">Fear of loneliness</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear2">
                <label for="fear2">Fear of rejection</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear3">
                <label for="fear3">Fear of intimacy</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear4">
                <label for="fear4">Fear of abandonment</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear5">
                <label for="fear5">Fear of not being forgiven</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear6">
                <label for="fear6">Fear of feelings</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear7">
                <label for="fear7">Fear of vulnerability</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear8">
                <label for="fear8">Fear of self-expression</label>
            </div>
        </div>

        <div class="subcategory">
            <h3>Health and Mortality</h3>
            <div class="fear-item">
                <input type="checkbox" id="fear9">
                <label for="fear9">Fear of dying</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear10">
                <label for="fear10">Fear of disease</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear11">
                <label for="fear11">Fear of physical pain</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear12">
                <label for="fear12">Fear of growing old</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear13">
                <label for="fear13">Fear of hospitals</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear14">
                <label for="fear14">Fear of insanity</label>
            </div>
        </div>

        <div class="subcategory">
            <h3>Recovery-Related</h3>
            <div class="fear-item">
                <input type="checkbox" id="fear15">
                <label for="fear15">Fear of relapsing</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear16">
                <label for="fear16">Fear of sobriety</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear17">
                <label for="fear17">Fear of writing the fourth step</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear18">
                <label for="fear18">Fear of working the program</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear19">
                <label for="fear19">Fear of taking service commitments</label>
            </div>
        </div>
    </div>

    <div class="category">
        <h2>Social and Relationship Fears</h2>
        
        <div class="subcategory">
            <h3>Family Concerns</h3>
            <div class="fear-item">
                <input type="checkbox" id="fear20">
                <label for="fear20">Fear of losing spouse</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear21">
                <label for="fear21">Fear of losing children</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear22">
                <label for="fear22">Fear of parents</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear23">
                <label for="fear23">Fear of commitment</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear24">
                <label for="fear24">Fear of dating</label>
            </div>
        </div>

        <div class="subcategory">
            <h3>Social Situations</h3>
            <div class="fear-item">
                <input type="checkbox" id="fear25">
                <label for="fear25">Fear of other people's opinions</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear26">
                <label for="fear26">Fear of public humiliation</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear27">
                <label for="fear27">Fear of confrontation</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear28">
                <label for="fear28">Fear of disapproval</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear29">
                <label for="fear29">Fear of judgment</label>
            </div>
        </div>
    </div>

    <div class="category">
        <h2>External Fears</h2>
        
        <div class="subcategory">
            <h3>Authority and Institutions</h3>
            <div class="fear-item">
                <input type="checkbox" id="fear30">
                <label for="fear30">Fear of God or higher power</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear31">
                <label for="fear31">Fear of police</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear32">
                <label for="fear32">Fear of jail</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear33">
                <label for="fear33">Fear of authority figures</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear34">
                <label for="fear34">Fear of government</label>
            </div>
        </div>

        <div class="subcategory">
            <h3>Financial and Security</h3>
            <div class="fear-item">
                <input type="checkbox" id="fear35">
                <label for="fear35">Fear of financial strain</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear36">
                <label for="fear36">Fear of material loss</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear37">
                <label for="fear37">Fear of employment</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear38">
                <label for="fear38">Fear of unemployment</label>
            </div>
            <div class="fear-item">
                <input type="checkbox" id="fear39">
                <label for="fear39">Fear of creditors</label>
            </div>
        </div>
    </div>

    <div class="button-container">
        <button class="download-btn" onclick="downloadCheckedFears()">Download Selected Fears</button>
        <button class="upload-btn" onclick="document.getElementById('fileInput').click()">Upload Saved Inventory</button>
        <button class="analyze-btn" onclick="createAnalysisSections()">Analyze Selected Fears</button>
        <button class="clear-btn" onclick="clearAllFears()">Clear All</button>
    </div>

    <script>
        // Wait for the document to be ready
        document.addEventListener('DOMContentLoaded', () => {
            // Get the file input element
            const fileInput = document.getElementById('fileInput');
            
            // Add the change event listener to the file input
            fileInput.addEventListener('change', async (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                try {
                    // Read the file content
                    const text = await file.text();
                    
                    // Clear existing fears
                    clearAllFears(false);
                    
                    // Process each section
                    const sections = text.split('===').filter(section => section.trim());
                    
                    sections.forEach(section => {
                        const lines = section.trim().split('\n')
                            .map(line => line.trim())
                            .filter(line => line);
                        
                        if (lines.length === 0) return;
                        
                        const fearTitle = lines[0];
                        
                        // Find the matching checkbox
                        document.querySelectorAll('label').forEach(label => {
                            if (label.textContent.trim() === fearTitle) {
                                // Check the box
                                const checkbox = label.previousElementSibling;
                                checkbox.checked = true;
                                
                                // Create analysis section
                                const fearItem = checkbox.closest('.fear-item');
                                const analysisSection = document.createElement('div');
                                analysisSection.className = 'analysis-section';
                                
                                // Extract content
                                let selfEsteem = '';
                                let relationships = '';
                                let security = '';
                                let ambitions = '';
                                let emotional = '';
                                
                                for (let i = 0; i < lines.length; i++) {
                                    const line = lines[i];
                                    const nextLine = lines[i + 1];
                                    
                                    switch(line) {
                                        case 'Self-esteem:':
                                            selfEsteem = nextLine || '';
                                            break;
                                        case 'Personal Relationships:':
                                            relationships = nextLine || '';
                                            break;
                                        case 'Security:':
                                            security = nextLine || '';
                                            break;
                                        case 'Ambitions:':
                                            ambitions = nextLine || '';
                                            break;
                                        case 'Emotional Well-being:':
                                            emotional = nextLine || '';
                                            break;
                                    }
                                }
                                
                                // Create the analysis HTML
                                analysisSection.innerHTML = `
                                    <h4>${fearTitle} - Analysis</h4>
                                    <div class="analysis-prompt">
                                        <strong>Self-esteem:</strong>
                                        <textarea class="analysis-textarea">${selfEsteem}</textarea>
                                    </div>
                                    <div class="analysis-prompt">
                                        <strong>Personal Relationships:</strong>
                                        <textarea class="analysis-textarea">${relationships}</textarea>
                                    </div>
                                    <div class="analysis-prompt">
                                        <strong>Security:</strong>
                                        <textarea class="analysis-textarea">${security}</textarea>
                                    </div>
                                    <div class="analysis-prompt">
                                        <strong>Ambitions:</strong>
                                        <textarea class="analysis-textarea">${ambitions}</textarea>
                                    </div>
                                    <div class="analysis-prompt">
                                        <strong>Emotional Well-being:</strong>
                                        <textarea class="analysis-textarea">${emotional}</textarea>
                                    </div>
                                `;
                                
                                fearItem.appendChild(analysisSection);
                            }
                        });
                    });
                    
                    // Update the display
                    createAnalysisSections();
                    
                } catch (error) {
                    console.error('Error processing file:', error);
                    alert('Error processing file: ' + error.message);
                }
            });
        });

        function downloadCheckedFears() {
            let content = "FEAR INVENTORY AND ANALYSIS\n\n";
            
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
                const fearItem = checkbox.closest('.fear-item');
                const fearText = checkbox.nextElementSibling.textContent;
                content += `=== ${fearText} ===\n\n`;
                
                const analysisSection = fearItem.querySelector('.analysis-section');
                if (analysisSection) {
                    const textareas = analysisSection.querySelectorAll('.analysis-textarea');
                    const prompts = ['Self-esteem:', 'Personal Relationships:', 'Security:', 'Ambitions:', 'Emotional Well-being:'];
                    
                    textareas.forEach((textarea, index) => {
                        content += `${prompts[index]}\n${textarea.value || 'No analysis provided'}\n\n`;
                    });
                }
                
                content += '\n';
            });

            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', 'fear_inventory_analysis.txt');
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function parseFearInventory(text) {
            const fears = [];
            const sections = text.split('===').filter(section => section.trim());
            
            sections.forEach(section => {
                const lines = section.trim().split('\n');
                if (lines.length > 0) {
                    fears.push(lines[0].trim());
                }
            });
            
            return fears;
        }

        function clearAllFears(showConfirmation = true) {
            if (!showConfirmation || confirm('Are you sure you want to clear all selections?')) {
                const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
            }
        }

        function createAnalysisSections() {
            // Remove any existing analysis sections
            document.querySelectorAll('.analysis-section').forEach(section => section.remove());
            
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            
            // Hide unselected fears but keep checked ones visible
            checkboxes.forEach(checkbox => {
                const fearItem = checkbox.closest('.fear-item');
                if (!checkbox.checked) {
                    fearItem.style.display = 'none';
                } else {
                    fearItem.style.display = 'flex'; // Ensure checked items are visible
                }
            });

            // Hide empty subcategories
            document.querySelectorAll('.subcategory').forEach(subcategory => {
                const checkedFears = subcategory.querySelectorAll('input[type="checkbox"]:checked').length;
                if (checkedFears === 0) {
                    subcategory.style.display = 'none';
                } else {
                    subcategory.style.display = 'block'; // Keep subcategories with checked items visible
                }
            });

            // Hide empty categories
            document.querySelectorAll('.category').forEach(category => {
                const checkedFears = category.querySelectorAll('input[type="checkbox"]:checked').length;
                if (checkedFears === 0) {
                    category.style.display = 'none';
                } else {
                    category.style.display = 'block'; // Keep categories with checked items visible
                }
            });

            // Create analysis sections for checked fears
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    const fearText = checkbox.nextElementSibling.textContent;
                    const fearItem = checkbox.closest('.fear-item');
                    
                    const analysisSection = document.createElement('div');
                    analysisSection.className = 'analysis-section';
                    analysisSection.innerHTML = `
                        <h4>${fearText} - Analysis</h4>
                        
                        <div class="analysis-prompt">
                            <strong>Self-esteem:</strong>
                            <textarea class="analysis-textarea" 
                                placeholder="How does this fear affect your self-worth and self-image?"></textarea>
                        </div>
                        
                        <div class="analysis-prompt">
                            <strong>Personal Relationships:</strong>
                            <textarea class="analysis-textarea" 
                                placeholder="How does this fear impact your relationships with others?"></textarea>
                        </div>
                        
                        <div class="analysis-prompt">
                            <strong>Security:</strong>
                            <textarea class="analysis-textarea" 
                                placeholder="How does this fear affect your sense of security (emotional, financial, etc.)?"></textarea>
                        </div>
                        
                        <div class="analysis-prompt">
                            <strong>Ambitions:</strong>
                            <textarea class="analysis-textarea" 
                                placeholder="How does this fear influence your goals and aspirations?"></textarea>
                        </div>
                        
                        <div class="analysis-prompt">
                            <strong>Emotional Well-being:</strong>
                            <textarea class="analysis-textarea" 
                                placeholder="How does this fear affect your emotional state and daily life?"></textarea>
                        </div>
                    `;
                    
                    fearItem.appendChild(analysisSection);
                }
            });

            // Add a "Show All Fears" button
            const buttonContainer = document.querySelector('.button-container');
            const showAllButton = document.createElement('button');
            showAllButton.className = 'analyze-btn';
            showAllButton.textContent = 'Show All Fears';
            showAllButton.onclick = showAllFears;
            buttonContainer.appendChild(showAllButton);

            // Update the download function to include analysis
            updateDownloadFunction();
        }

        function showAllFears() {
            // Show all fear items
            document.querySelectorAll('.fear-item').forEach(item => {
                item.style.display = 'flex';
            });

            // Show all subcategories
            document.querySelectorAll('.subcategory').forEach(subcategory => {
                subcategory.style.display = 'block';
            });

            // Show all categories
            document.querySelectorAll('.category').forEach(category => {
                category.style.display = 'block';
            });

            // Remove the "Show All Fears" button
            const showAllButton = document.querySelector('.button-container .analyze-btn:last-child');
            if (showAllButton) {
                showAllButton.remove();
            }
        }

        // Update the clear function to show all fears
        function clearAllFears(showConfirmation = true) {
            if (!showConfirmation || confirm('Are you sure you want to clear all selections?')) {
                const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Remove any analysis sections
                document.querySelectorAll('.analysis-section').forEach(section => {
                    section.remove();
                });

                // Show all fears
                showAllFears();
            }
        }

        function updateDownloadFunction() {
            window.downloadCheckedFears = function() {
                let content = "FEAR INVENTORY AND ANALYSIS\n\n";
                
                document.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
                    const fearItem = checkbox.closest('.fear-item');
                    const fearText = checkbox.nextElementSibling.textContent;
                    content += `=== ${fearText} ===\n\n`;
                    
                    const analysisSection = fearItem.querySelector('.analysis-section');
                    if (analysisSection) {
                        const textareas = analysisSection.querySelectorAll('.analysis-textarea');
                        const prompts = ['Self-esteem:', 'Personal Relationships:', 'Security:', 'Ambitions:', 'Emotional Well-being:'];
                        
                        textareas.forEach((textarea, index) => {
                            content += `${prompts[index]}\n${textarea.value || 'No analysis provided'}\n\n`;
                        });
                    }
                    
                    content += '\n';
                });

                const element = document.createElement('a');
                element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
                element.setAttribute('download', 'fear_inventory_analysis.txt');
                element.style.display = 'none';
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            };
        }
    </script>
</body>
</html>
